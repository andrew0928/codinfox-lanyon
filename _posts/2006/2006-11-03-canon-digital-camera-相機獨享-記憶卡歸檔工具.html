---
layout: post
title: "Canon Digital Camera 相機獨享 - 記憶卡歸檔工具"
categories:
- ".NET"
- "技術隨筆"
- "有的沒的"
tags: [".NET","技術隨筆","有的沒的"]
published: true
comments: true
permalink: "/2006/11/02/canon-digital-camera-相機獨享-記憶卡歸檔工具/"
redirect_from:
  - /columns/post/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab-e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /post/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab-e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /post/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab-e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /columns/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab-e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /columns/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab-e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /columns/post/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab---e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /post/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab---e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /post/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab---e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /columns/2006/11/03/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab---e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /columns/Canon-Digital-Camera-e79bb8e6a99fe78da8e4baab---e8a898e686b6e58da1e6adb8e6aa94e5b7a5e585b7.aspx/
  - /blogs/chicken/archive/2006/11/03/1914.aspx/
wordpress_postid: 213
---
<p>用數位相機的人或多或少都有這困擾吧? 不用底片錢, 也不用洗出來, 相機拿起來就是拼命拍... 拍完後, 不要說後製作了, 光是把相片檔案歸檔就有點麻煩...</p> <p>&nbsp;</p> <p>"我久久才 copy 一次照片, 要照日期分目錄真麻煩"</p> <p>"video 檔歸檔也麻煩"</p> <p>"直拍的照片要轉 90' 得一張一張看.."</p> <p>"兩台相機檔名重覆... " &lt;--- 這個大概只有我會碰到吧, 我家的相機都是 canon ...</p> <p>"...."</p> <p>&nbsp;</p> <p>這些問題,&nbsp;其實都有很好的工具可以解決, Google 的那套 Picasa 就很棒, 不然 Adobe 的 Album, AcdSee 也都有 solution ...</p> <p>不過我就是不想裝一些五四三的啊... 看照片我都只用 windows xp 內建的 image viewer, 我只缺一個很簡單的工具, 把記憶卡的照片檔案自動搬到我要的目錄就好... 可以的話我甚至不要 windows 介面的, 可以用命令列執行的更棒... (我果然是老人.. :~~~~)</p> <p>最後是自己寫一個來用... 過去是寫簡單的批次檔就搞定, 也用了兩年了, 成效很好, 我就直接把內容貼出來, 有需要的人可以拿去用...</p> <p>&nbsp;</p> <div> <p><font color="#0000ff">set DATETEXT=%DATE:~0,4%-%DATE:~5,2%%DATE:~8,2%<br>if not "%2"=="" set DATETEXT=%2 </font></p> <p><font color="#0000ff">set TRGDIR="c:\Photos\%DATETEXT% [%1]\"<br>md %TRGDIR% </font> <p><font color="#0000ff">@echo "處理 F:\DCIM 的照片..."<br>@ for /R F:\DCIM %%f in (*.jpg) do @echo 移動照片中... %%f &amp;&amp; @move /-Y %%f %TRGDIR% &gt; nul<br>@ for /R F:\DCIM %%f in (*.crw) do @echo 移動照片中... %%f &amp;&amp; @move /-Y %%f %TRGDIR% &gt; nul<br>@ for /R F:\DCIM %%f in (*.avi) do @echo 移動影片中... %%f &amp;&amp; @move /-Y %%f "c:\videos\input [dc-avi]\%DATETEXT% [%1 #%%~nf].avi" &gt; nul<br>@ for /R F:\DCIM %%f in (*.thm) do @echo 刪除影片縮圖... %%f &amp;&amp; @del /f /q %%f &gt; nul</font> </p></div> <p>&nbsp;</p> <p>批次檔的方式已經可以解決這些問題:</p> <ol> <li>依日期命名, 像這樣的格式:<br>c:\photos\2006-0101 [去公園]\IMG_9999.jpg  <li>因為我有另外處理 video file 的動作, 因此 avi 檔會另外分開放, 格式為:<br>c:\videos\2006-0101 [去公園 #MVI_9999].avi  <li>只要執行這指令, 檔案就都歸好了:<br>copypic.cmd 去公園<br>或是自己指定日期...<br>copypic.cmd 去公園 2006-0101</li></ol> <p>不過用起來還是有一點小缺點:</p> <ol> <li>日期判定不精確, 因為只寫批次檔的話, 我找不到方法把檔案日期切一段出來... 因此歸檔的檔名只能用 copy 時的日期來算... 常常白天拍, 晚上過十二點哄完小孩才來 copy, 日期就差一天  <li>因為 (1), 累積了好幾天的照片只能混在一起, 分不開  <li>沒辦法以相機名稱命名, 兩台相機照出來的檔名常打架  <li>要自動轉正</li></ol> <p>像是要讀取 EXIF 的部份, 要光靠批次檔真的是太勉強了... 本來想寫個小工具搭配批次檔用, 不過發現花的工夫跟本差不多... 就直接寫了一個小工具 [DigitalCameraFiler.exe],&nbsp;取代掉上面的批次檔了..</p> <p>需要的人可以下載去用, 不過喜歡用命令列的人應該不多吧... 哈哈... 用法很簡單... 請先確定你的電腦有安裝 Microsoft .Net Framework 2.0... 安裝設定的方式:</p> <ol> <li>編輯設定檔: DigitalCameraFiler.exe.config<br> <div> <div style="font-size: 12pt; background: white; color: black; font-family: fixedsys"> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;<span style="color: blue">&lt;?</span><span style="color: maroon">xml</span><span style="color: blue"> </span><span style="color: red">version</span><span style="color: blue">=</span>"<span style="color: blue">1.0</span>"<span style="color: blue"> </span><span style="color: red">encoding</span><span style="color: blue">=</span>"<span style="color: blue">utf-8</span>"<span style="color: blue"> ?&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;<span style="color: blue">&lt;</span><span style="color: maroon">configuration</span><span style="color: blue">&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;<span style="color: blue"> &lt;</span><span style="color: maroon">appSettings</span><span style="color: blue">&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;<span style="color: blue">&nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">key</span><span style="color: blue">=</span>"<span style="color: blue">default.title</span>"<span style="color: blue"> </span><span style="color: red">value</span><span style="color: blue">=</span>"<span style="color: blue">未定標題</span>"<span style="color: blue">/&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;<span style="color: blue">&nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">key</span><span style="color: blue">=</span>"<span style="color: blue">video.targetPattern</span>"<span style="color: blue"> </span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;6</span>&nbsp;<span style="color: blue">&nbsp;&nbsp; </span><span style="color: red">value</span><span style="color: blue">=</span>"<span style="color: blue">c:\video\{0:yyyy-MMdd} [{1} #{4}].avi</span>"<span style="color: blue"> /&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;7</span>&nbsp;<span style="color: blue">&nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">key</span><span style="color: blue">=</span>"<span style="color: blue">general.targetPattern</span>"<span style="color: blue"> </span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;8</span>&nbsp;<span style="color: blue">&nbsp;&nbsp; </span><span style="color: red">value</span><span style="color: blue">=</span>"<span style="color: blue">c:\photos\{0:yyyy-MMdd} [{1}]\{3}</span>"<span style="color: blue"> /&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;9</span>&nbsp;<span style="color: blue">&nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">key</span><span style="color: blue">=</span>"<span style="color: blue">photo.targetPattern</span>"<span style="color: blue"> </span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;10</span>&nbsp;<span style="color: blue">&nbsp;&nbsp; </span><span style="color: red">value</span><span style="color: blue">=</span>"<span style="color: blue">c:\photos\{0:yyyy-MMdd} [{1}]\{2} #{3}</span>"<span style="color: blue"> /&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;11</span>&nbsp;<span style="color: blue">&nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">key</span><span style="color: blue">=</span>"<span style="color: blue">arguments</span>"<span style="color: blue"> </span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;12</span>&nbsp;<span style="color: blue">&nbsp;&nbsp; </span><span style="color: red">value</span><span style="color: blue">=</span>"<span style="color: blue">LastWriteTime,Title,Model,Name,<br>FileNameWithoutExtension</span>"<span style="color: blue">/&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;13</span>&nbsp;<span style="color: blue"> &lt;/</span><span style="color: maroon">appSettings</span><span style="color: blue">&gt;</span></p> <p style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;14</span>&nbsp;<span style="color: blue">&lt;/</span><span style="color: maroon">configuration</span><span style="color: blue">&gt;</span></p></div></div>default.title: 預設的主題,&nbsp;執行時沒給 title 的話就用這個代替<br>video.targetPattern: 放 *.avi 檔的位置, 其中 {0} {1} .. 會用最後面的 arguments 依序代替<br>general.targetPattern: 放&nbsp;*.crw 檔的位置<br>photo.targetPattern: 放 *.jpg 檔的位置  <li>執行時, 打開 DOS Prompt, 切到目錄下, 執行:<br>DigitalCameraFilter.exe&nbsp;F:\ 公園外拍<br>其中, F:\ 是指你記憶卡的路逕, "公園外拍" 是主題</li></ol> <p>photo 為例, 最後檔案會被歸到:</p> <p>c:\photos\2006-1102 [公園外拍]\Canon PowerShot G2 #IMG_1234.jpg</p> <p>大概就是這樣, 自己寫來用的, 覺的好用的話就鼓勵一下吧 :D</p> <p><a href="http://www.chicken-house.net/files/chicken/ChickenHouse.Tools.DigitalCameraFiler.Binary.zip">下載程式</a></p>