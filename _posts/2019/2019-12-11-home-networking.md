---
layout: post
title: "水電工日誌 7. 事隔 12 年的家用網路架構大翻新"
categories:
- "系列文章: 水電工日誌"
tags: ["水電工", "有的沒有的"]
published: true
comments: true
redirect_from:
logo: 
---

http://teledataafrica.com/wp-content/uploads/2018/01/Networking-Blog.jpg



好久不見的 "水電工日誌" 又出現了 !

自從 12 年前，家裡重新整修了一番，花了不少時間把家裡的區域網路弄起來後，就再也沒花功夫去搞他了，只能說在家裡先佈好足夠的網路線，還有一個可靠的機櫃真是好用啊 (果然是阿宅的夢想)。不過四個多月前，一次台電計畫性的停電，就把我家的 router 跟 switch 搞掛了, router 事後莫名其妙的又活起來, 但是終究壽命已盡, 在一個月前又掛了, 再也救不起來...

事後發現，停電根本不是真正的原因啊 (我有 UPS, 又有事先主動關機...), 根本原因就是裡面的電容都鼓起來了, 單純關機就再也開不起來而已... 雖然掛掉的 router 被蘇老妙手回春救回來, 不過我替他安排好退休生活了, 趁著雙十一敗家合理 (根本沒優惠啊啊啊) 的氛圍下，我把家裡的網路設備都換了一輪了... Orz

這次替換，主要有兩大目的，其一是我要換掉困擾我很久的 WiFi 網路連線問題；另一個就是網路的基礎架構 router / switch 的結構問題 (VLAN)。前面那系列水電工日誌，已經是 12 年前。當年的重點在從無到有，都在弄佈線等等施工的問題，網路的架構 (其實當時也不懂) 只要設備正常能動能上網就好了。當時甚至沒用啥路由器，還是自己架 server, 插上兩張網卡自己弄軟體的 NAT server ...

這次趁著 "天災" ，折損了一些設備，不得不正面面對這些問題了，剛好就半推半就，把看了很久的設備買進來。辛苦摸索了近一個月，總算搞定了 (所以才會有這篇文章)。許久不見的水電工日誌，就這樣重返江湖了 :D





# 敗家有理: UniFi AP
































寫在前面:

其實我對網管是個大外行，出社會後就一直從事軟體開發的工作 (雖然大學念的是通訊領域的科系) ... 會想自己在家架設網路，純粹是阿宅的天性使然，單純想享受在家裡自己蓋起我理想中的網路環境 (就是自嗨) 的成就感而已。除了成就感之外，另一個很重要的原因，就是我往往都可以在網路設備上，找到解決問題的靈感。

靈感? 應該這麼說，網路設備算是硬體，但是要解決的都是很複雜的網路環境需求，尤其是路由器或是防火牆這類的設備。我常在想，為什麼面對複雜的問題 (每間公司的網路環境其實落差都很大)，為何網路設備都有這麼高的適應能力? 雖然都有很複雜的設定，但是受過訓練的網管總是有辦法正確的設定，解決各種複雜的網路環境需求。我想其中一部分的道理，就是這些問題，都被歸納出很一致的規則，例如 VLAN 就是 package + tag 的應用, router 就是各種 routing table / firewall policy 的組合...。

由於這些複雜的問題已經被梳理成背後一些網通產業的 "領域知識"，因此設備廠商只要時做這些 "領域知識" 的管理介面，訓練有素的網管就能把整個環境蓋起來。我在面對一些其他應用程式的複雜問題時，往往能從這些做法中找到一些靈感，例如利用 rules + priority 的組合, 就能取代大量的開關設定。